// Code generated by configgen. DO NOT EDIT.
// Код сгенерирован configgen. НЕ РЕДАКТИРОВАТЬ.

package {{ .Package }}
{{ if needsTime .Fields }}
import "time"
{{ end }}

// Environment представляет окружение развертывания
type Environment string

const (
	EnvLocal      Environment = "local"
	EnvDev        Environment = "dev"
	EnvStaging    Environment = "stg"
	EnvProduction Environment = "prod"
)

// Config основная структура конфигурации
type Config struct {
	Env Environment `toml:"-"`
{{- range $i, $k := .Keys }}
{{- $field := index $.Fields $k }}
{{- if hasComment $field.Comment }}
	{{ formatComment $field.Comment }}
{{- end }}
	{{ $field.Name }} {{ GoType $field }} `toml:"{{ $field.TOMLName }}"`
{{- end }}
}

func (c *Config) IsProduction() bool { return c.Env == EnvProduction }
func (c *Config) IsStg() bool        { return c.Env == EnvStaging }
func (c *Config) IsLocal() bool      { return c.Env == EnvLocal }
func (c *Config) GetEnv() string     { return string(c.Env) }

//go:generate minimock -i Configurator -o ./mock/ -s _mock.go -g

// Configurator интерфейс для мокирования конфигурации в тестах
type Configurator interface {
	IsProduction() bool
	IsStg() bool
	IsLocal() bool
	GetEnv() string
}

{{/* Генерируем вложенные структуры */}}
{{- range $i, $k := .Keys }}
{{- $f := index $.Fields $k }}
{{- if eq $f.Kind 4 }}

{{- if hasComment $f.Comment }}
{{ formatComment $f.Comment }}
{{- end }}
// {{ $f.Name }} секция конфигурации
type {{ $f.Name }} struct {
{{- $keys := keys $f.Children }}
{{- range $j, $kk := $keys }}
{{- $cf := index $f.Children $kk }}
{{- if hasComment $cf.Comment }}
	{{ formatComment $cf.Comment }}
{{- end }}
	{{ $cf.Name }} {{ GoType $cf }} `toml:"{{ $cf.TOMLName }}"`
{{- end }}
}
{{- end }}
{{- end }}
